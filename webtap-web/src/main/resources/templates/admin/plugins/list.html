<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorator="admin/layout">

<head>
    <style>
        .plugin-nav {
            height: 26px;
            width: 95%;
            border-bottom: 1px solid #cccccc;
            margin:20px;
            margin-top:50px;
        }

        .plugin-nav ul {
            list-style-type: none;
            padding: 0px;
            float: left;
            position: relative;/*子元素absol*/
        }

        .plugin-nav  ul li {
            width: 80px;
            height: 26px;
            text-align: center;
            float: left;
        }

        .current{
            border-bottom: 4px solid #573173;
        }
        .plugin-nav  ul li a {
            color: #848789;
            text-decoration: none;
            line-height: 26px;
        }
        .plugin-nav   ul a:hover{
            color: #573173;
        }

        .plugin-list{
            border: 1px solid #cccccc;
            width: 40%;
            /* height: 100px; */
            float: left;
            display: inline;
            padding: 10px;
            margin: 10px;
            margin-left:20px;
            height: 120px;
            border-radius: 4px;
        }
        .plugin-pic {
            float: left;
        }
        .plugin-text{
            width: 65%;
            float: left;
            padding-left: 10px;
        }
        .plugin-name{
            display: block;
            font-size: 16px;
            color: #007bff;
        }
        .plugin-description{
            display: block;
            padding-top: 10px;
        }
        .plugin-from{
            display: block;
            padding-top: 10px;}
        .plugin-btn{float: right}

        #tb-installed{
            margin-left: 20px;
            width: 95%;
        }

        #tb-installed .table thead{
            background-color: #F2F2F2;
            border: none;
        }

        #tb-installed .table tr,#tb-installed .table td,#tb-installed .table th,#tb-installed .table thead th{
            border: none;
        }
        .circle{
            border-radius: 5px;
            height: 10px;
            width: 10px;
            float: left;
            margin-right: 5px;
            margin-top: 5px;
        }
        .red {background-color: red;}
        .green{background-color: green}

    </style>
</head>

<div layout:fragment="content" >
    <!-- content-->

    <div class="">
        <div id="app-body"   class="bf-body">

            <h3 class="page-title">插件管理</h3>
            <button type="button"   class="btn btn-outline-primary btn-sm"  style="float: left; margin-left:150px;margin-top:-38px;height: 30px;line-height: 30px" >上传插件</button>

            <div class="plugin-nav">
                <ul>
                    <li class="current">我的插件</li>
                    <li>推荐插件</li>
                </ul>
            </div>
            <!-- Grid -->


            <div id="tb-installed" style="display: none">
                <table class="table" >
                    <thead>
                    <tr>
                        <th>名称</th>
                        <th>描述</th>
                        <th style="text-align: center">操作</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>webtap-redis-plugin<div class="circle red"></div> </td>
                        <td>
                            <span style="color: #7F7F7F">轻量级 redis管理工具，直接通过web管理redis数据</span>
                            <br> V3.0.1版本 来自 <a href="">robotbird</a>
                        </td>
                        <td style="text-align: center">
                            <a href="">启用</a>
                            <a href="">卸载</a>
                            <a href="">设置</a>
                        </td>
                    </tr>

                    <tr>
                        <td>sqlite-plugin<div class="circle green"></div> </td>
                        <td>
                            <span style="color: #7F7F7F">sqlite在线管理工具，通过web可以直接管理sqlite数据库</span>
                            <br> v1.0.1版本 来自 <a href="">robotbird</a>
                        </td>
                        <td style="text-align: center">
                            <a href="">停用</a>
                            <a href="">卸载</a>
                            <a href="">设置</a>
                        </td>
                    </tr>


                    </tbody>
                </table>

            </div>

            <div  id="tb-plugins" style="display: none">


                <div  class="plugin-list" >
                    <div class="plugin-pic"><img src="http://webtap.cn/upload/logo/photoshop.png"></div>
                    <div class="plugin-text">
                        <a class="plugin-name">插件名称</a>
                        <span class="plugin-description">插件描述</span>
                        <span class="plugin-from">来自 <a href="#">作者</a></span>
                    </div>
                   <div class="plugin-btn"><button class="btn btn-outline-primary btn-sm " style="height: 30px;line-height: 30px">启用</button></div>

                </div>

                <div  class="plugin-list" >
                    图片2
                </div>


            </div>

            <!--/Grid -->



        </div>
    </div>



</div>



<th:block layout:fragment = "bodyAssets">

    <script>
        Vue.use(window.vuelidate.default);

        const app = new Vue({
            el: '#app-body',
            id:0,
            data: {
                category:{editType:"新增"},
                plugins:{},
                appdata:{}
            },

            methods: {
                load: function () {

                    axios.get(webRoot + 'plugin')
                        .then(response => {
                        this.plugins = response.data;
                }).catch(function (error) { toastr.error(error); });
                },
                save: function () {
                    var posturl =webRoot + 'api/apps/save' ;

                    var logoUrl =  $("#app-logoUrl").val();
                    if(logoUrl!=""){
                        if(logoUrl.indexOf('/')>0&&logoUrl.indexOf("http")<0){
                            logoUrl =  webRoot + $("#app-logoUrl").val();
                        }
                    }
                    this.appdata.logoUrl = logoUrl;
                    var app = this.appdata;
                    app.passwordRequired = app.passwordRequired?"1":"0";
                    axios.post(posturl, app)
                        .then(function (response) {
                            if(response.data.rspCode!="000000"){
                                toastr.error(response.data.rspCode+" "+response.data.rspMsg);
                            }else {
                                toastr.success(response.data.rspMsg);
                                setTimeout(function () { location.href = webRoot +"admin/app/list"; }, 1000);
                            }
                        })
                        .catch(function (error) {
                            toastr.error(error);
                        });
                },
                saveCategory:function(){
                    var posturl =webRoot + 'api/category/save' ;
                    var cat = this.category;
                    axios.post(posturl, cat)
                        .then(function (response) {
                            var _cat = response.data;
                            app.$data.categories.push(_cat);
                            app.$data.appdata.categoryId = _cat.id;
                            $("#modal-category").modal("hide");
                        })
                        .catch(function (error) {
                            toastr.error(error);
                        });
                },
                addCat:function(){
                    this.category = {editType:"新增"};
                    $("#modal-category").modal();
                },
                openFile:function () {
                    fileManagerController.open(insertAppLogoCallback);
                }
            },
            beforeMount() {
                if (fromQueryString('id')) {
                    this.id = fromQueryString('id');
                }

                //this.load();
            }
        })

        var t;
        if(fromQueryString('t')){
            t = fromQueryString('t')
            if(t =='installed'){
                $('#tb-installed').show();
                $('#tb-plugins').hide()
            }else {
                $('#tb-installed').hide();
                $('#tb-plugins').show()
            }
        }else {
            $('#tb-installed').show();
            $('#tb-plugins').hide()
        }

    </script>


    <script src="/admin/js/app/fileManagerController.js"></script>
</th:block>
