<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"></meta>
    <title>WebTap</title>

    <link rel="stylesheet" type="text/css" href="css/zeroModal.css" />
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        .box_wrapper{
            background: #cccccc;
            background-position: center center;
            background-size: cover;
            height: 100%;
            left: 0;
            margin: 0;
            padding: 0;
            position: fixed;
            top: 0;
            transition: opacity 700ms;
            width: 100%;
        }
        .goole{
            margin: 160px auto 24px;
            width: 272px;
            height: 92px;
        }
        .goole img{
            display: block;
            width: 100%;
        }
        .search{
            width: 560px;
            height: 44px;
            margin: 0 auto;
            background: #fff;
            border-radius: 50px;
            position: relative;
        }
        .search input{
            font-size: 18px;
            line-height: 42px;
            background: transparent;
            border: none;
            bottom: 0;
            box-sizing: border-box;
            left: 15px;
            margin: 0;
            outline: none;
            padding: 0 8px;
            position: absolute;
            top: 2px;
            width: 88%;
        }
        .search span{
            position: absolute;
            right: 20px;
            font-size: 18px;
            line-height: 42px;
            color: #ccc;
            cursor: pointer;
        }
        .icon_list{
            width: 560px;
            margin: 35px auto 0;
            list-style: none;
        }
        .icon_list li{
            float: left;
            width: 112px;
            height: 112px;
            position: relative;
        }
        .title{
            width: 48px;
            height: 48px;
            margin: 0 auto 16px;
        }
        .goole_icon{
            font-size: 48px!important;
        }
        .desc{
            text-align: center; color: #fff;
        }
        .desc a,.desc a:link,.desc a:hover,.desc a:visited{
            text-decoration: none; color: #fff;
        }
        .icon {
            width: 1em; height: 1em;
            vertical-align: -0.15em;
            fill: currentColor;
            overflow: hidden;
        }
        .full-background-wall{
            position:fixed;
            top: 0;
            left: 0;
            width:100%;
            height:100%;
            min-width: 1000px;
            z-index:-10;
            zoom: 1;
            background-size: cover;
            -webkit-background-size: cover;
            -o-background-size: cover;
            background: #666 no-repeat center 0;
            background-blend-mode:overlay;

        }
        .full-background-wall{background-image:url(upload/background/9.jpg)}

        .top-bar{
            height: 40px;
            line-height: 40px;
        }
        .top-bar .nav{float: left; color: #ffffff; padding-left: 80px;}
        .top-bar a,.top-bar a:link,.top-bar a:hover,.top-bar a:visited{ text-decoration: none;  color: #fff !important}

        .top-bar .profile{float:right; padding-right: 80px; }

        .top-bar .profile li{list-style: none; display: inline-block}
        .top-bar .profile li img{vertical-align: middle;}
        .user-pic{
            height: 32px;
            width: 32px;
            border-radius: 16px;
            background-color: #ececec;
            background-position: -11px -149px;
        }
        .settings-quick{

        }




        .autocomplete-suggestions { -webkit-box-sizing: border-box; -moz-box-sizing: border-box;
            box-sizing: border-box; border: 1px solid #999; background: #FFF; cursor: default;
            overflow: auto; -webkit-box-shadow: 1px 4px 3px rgba(50, 50, 50, 0.64);
            -moz-box-shadow: 1px 4px 3px rgba(50, 50, 50, 0.64); box-shadow: 1px 4px 3px rgba(50, 50, 50, 0.64);
         margin-left: -16px;margin-top: -10px; border-bottom-left-radius: 25px; border-bottom-right-radius:25px;}

        .autocomplete-suggestion {
            white-space: nowrap; overflow: hidden;
            padding: 2px 5px 2px 23px;
        }
        .autocomplete-no-suggestion { padding: 2px 5px 2px 23px;}
        .autocomplete-selected { background: #F0F0F0; }
        .autocomplete-suggestions strong { font-weight: bold; color: #000; }
        .autocomplete-group { padding: 2px 5px; font-weight: bold; font-size: 16px; color: #000; display: block; border-bottom: 1px solid #000; }
    </style>


</head>
<body>
<div id="app" class="box_wrapper full-background-wall">

    <div class="top-bar">
       <ul class="nav">
           <a href="http://webtap.cn/marketplace">应用</a>  |  <a href="http://webtap.cn/news">新闻</a>
       </ul>

        <ul class="profile">
            <li><a href="login">Sign in</a> </li>
            <li style="display: none"><img src="img/msg.png" alt="Message" /> </li>
            <li><span class="user-pic"></span> <img src="img/userpic.png" alt="User profile pic" /> </li>
            <li><span class="settings-quick"></span> <img src="img/nav-link.png" alt="Settings and quick links" /> </li>
        </ul>
    </div>

    <div class="goole"><img src="img/3.png" alt="Utry"></div>
    <div class="search">
        <input type="text" class="search_btn" id="autocomplete">
        <span class="iconfont icon-sousuo"></span>
    </div>
    <div id="selection"></div>
    <ul class="icon_list">


        <li v-for="cat in categories" :key="cat.id">
            <div class="title">
                <a href="javascript:_setOpacity()">  <img class="icon goole_icon"  src="img/fold.png" /></a>
            </div>
            <div class="desc">
                <a href="#" >{{cat.name}}</a>
            </div>
        </li>

        <li v-for="app in appList" :key="app.id">
            <div class="title">
                <a :href="app.url">  <img class="icon goole_icon"  v-bind:src="app.logoUrl" /></a>
            </div>
            <div class="desc">
                <a :href="app.url" >{{app.title}}</a>
            </div>
        </li>

    </ul>
</div>
</body>

<script src="/js/vue.min.js"></script>
<script src="/js/axios.min.js"></script>
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js"></script>
<script src="/js/zeroModal.min.js"></script>


<script>
    const app = new Vue({
        el: '#app',
        data: {
            categories:{},
            appList: {}
        },
        methods: {
            load: function () {
                this.loadCat();
                axios.get('api/apps')
                    .then(response => {
                    this.appList = response.data;
                    this.search();
                    }).catch(function (error) { console.log(error) });
            },
            loadCat:function(){
                axios.get('api/app/categories')
                    .then(response => {
                    this.categories = response.data;
                    }).catch(function (error) { console.log(error) });
            },
            search:function(){
                var appArr = this.appList;
                var appsRes = $.map(appArr,function (a) {
                    return {value:a.title,data:{category:'APP'}};
                });
                function reset_border_radius(){$(".search").css("border-radius","50px");}
                $('#autocomplete').autocomplete({
                    onSearchComplete:function(query,suggestions){
                        $(".search").css("border-radius","0px");
                        $(".search").css({"border-top-left-radius":"25px","border-top-right-radius":"25px"});

                        var sg_hidden = $(".autocomplete-suggestions").is(":hidden");
                        if(sg_hidden){
                            reset_border_radius();
                        }
                    },
                    onHide:function(){
                        var wd= $("#autocomplete").val();
                        if(wd ==""){
                            app.load();
                        }
                        reset_border_radius();

                    },
                    width:562,
                    lookup: appsRes,
                    minChars: 1,
                    onSelect: function (suggestion) {
                        var  sugArr = [];
                        for(var i=0;i<appArr.length;i++){
                            if(appArr[i].title == suggestion.value){
                                sugArr.push(appArr[i]);
                            }
                        }
                        app.$data.appList = sugArr;
                    },
                    showNoSuggestionNotice: true,
                    noSuggestionNotice: 'Sorry, no matching results'
                });

            }

        },
        beforeMount() {
            this.load()
        }
    });

    function _setOpacity() {

        var html='<ul class="icon_list"><li><div class="title"><a href="kk"><img src="/upload/logo/chandao.png" class="icon goole_icon"></a></div> <div class="desc"><a href="kk">lllll</a></div></li>\n' +
            '\n' +
            '<li><div class="title"><a href="来来来"><img src="/upload/logo/kod.png" class="icon goole_icon"></a></div> <div class="desc"><a href="来来来">000</a></div></li>\n' +
            '\n' +
            '<li><div class="title"><a href="http://www.italent.cn"><img src="/upload/logo/iconfont.png" class="icon goole_icon"></a></div> <div class="desc"><a href="http://www.italent.cn">图标</a></div></li></ul>';
        zeroModal.show({
            content: html,
            width: '40%',
            height: '60%',
            opacity: 0.8
        });
    }
</script>

</html>

